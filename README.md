# Piano Lights

Displays lights (LEDs) over piano keys as they are played in real-time. This runs on an Arduino Uno and lights up LEDs on an LED strip by listening for MIDI notes generated by the piano. This is a fork from https://github.com/ddribin/piano-lights-sw updated to work with ESP8266 and adding more expressive LED effects.

## Hardware

Here's the hardware used:

- NodeMCU ESP8266 - though likely would run fine with minimal changes on any ESP8266 or ESP32
- Midi Chip - this interfaces between the midi output of the piano and the ESP - https://www.roxxxtar.com/badassmidi-midi-chip
- [BTF Lighting LED strip](https://www.btf-lighting.com/collections/sk9822/products/1-sk9822-led-pixel-strip-data-and-clock-dc5v?variant=25941426831460): SK9822 chipset, 5 volts, 60 LEDs/meter, black PCB
- A digital piano or keyboard that outputs MIDI

**Note:** This will *not* work with Neopixel LED strips (WS2811/WS2812/WS2812B), only APA102 LED strips (SK9822 is an APA102 clone). Neopixels require bit banging, which disables interrupts for too long, and interferes with the hardware UART used by the MIDI port. APA102 can use the hardware SPI of the AVR. See the [FastLED Wiki page about interrupt problems](https://github.com/FastLED/FastLED/wiki/Interrupt-problems) for more information.

## Software

Here's the software used:

- [Arduino MIDI Library](https://github.com/FortySevenEffects/arduino_midi_library)
- [FastLED](https://fastled.io)
- [PlatformIO](https://platformio.org)

## How It Works

All the heavy lifting is done by the two libraries. The code reads MIDI note on and off events and turns on a corresponding LED. The LED colors are set using the HSV color space. Each key is mapped the hue, with the low A0 mapped to 0 and high C8 mapped to 255. There are two potentiometers on the MIDI shield. One is mapped to the saturation, and the other the value (brightness).

## Demo Video

https://photos.app.goo.gl/typxAoGbPmAJpxPf7
![[Demo Video](https://photos.app.goo.gl/typxAoGbPmAJpxPf7)](https://github.com/freakintoddles2/piano-lights-sw-enhanced/assets/14365082/f138a23c-c2ca-4aa8-ac8a-a2c93d961acc)
